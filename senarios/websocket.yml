config:
  target: 'ws://localhost:3000/graphql'
  phases:
    - duration: 10 # Test for 10 seconds
      arrivalRate: 10 # Every second, add 10 users
      # rampTo: 100    # And ramp it up to 100 users in total over the 60s period
      name: 'Ramping up the load'
  ws:
    # Set a custom subprotocol:
    subprotocols:
      # npm install -g artillery-engine-graphql-ws
      - graphql-ws
scenarios:
  - name: load testing subscription
    engine: ws
    flow:
      # - send:
      #     type: connection_init
      #     payload: {}
      - send:
          id: 1
          type: start
          payload:
            variables: {}
            extensions: {}
            operationName: RoomAdded
            query: "subscription RoomAdded {\n  roomAdded {\n    id\n    name\n    createdAt\n    __typename\n  }\n}\n"
      - think: 15
      - send:
          id: 1
          type: stop
